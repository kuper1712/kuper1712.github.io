<!DOCTYPE html><html lang="ko-KR" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="음성으로 TV제어하기 - 2.TV 제어" /><meta name="author" content="Jeong Junsu" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="음성으로 TV를 제어해 보자!" /><meta property="og:description" content="음성으로 TV를 제어해 보자!" /><link rel="canonical" href="https://kuper1712.github.io/posts/ir-remote2/" /><meta property="og:url" content="https://kuper1712.github.io/posts/ir-remote2/" /><meta property="og:site_name" content="kuper1712의 블로그" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-03T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="음성으로 TV제어하기 - 2.TV 제어" /><meta name="google-site-verification" content="kaBDTp-n-Yy9Wi8yl6yYvqNZgR-yCLhqvFR9lDGIn04" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jeong Junsu","url":"https://github.com/kuper0201/"},"dateModified":"2023-01-10T07:04:34+00:00","datePublished":"2020-03-03T00:00:00+00:00","description":"음성으로 TV를 제어해 보자!","headline":"음성으로 TV제어하기 - 2.TV 제어","mainEntityOfPage":{"@type":"WebPage","@id":"https://kuper1712.github.io/posts/ir-remote2/"},"url":"https://kuper1712.github.io/posts/ir-remote2/"}</script><title>음성으로 TV제어하기 - 2.TV 제어 | kuper1712의 블로그</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="kuper1712의 블로그"><meta name="application-name" content="kuper1712의 블로그"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/93369658?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">kuper1712의 블로그</a></div><div class="site-subtitle font-italic">개발 블로그입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/kuper1712" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kuper171','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>음성으로 TV제어하기 - 2.TV 제어</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>음성으로 TV제어하기 - 2.TV 제어</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1583193600" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2020/03/03 </em> </span> <span> 업데이트 <em class="" data-ts="1673334274" data-df="YYYY/MM/DD" data-toggle="tooltip" data-placement="bottom"> 2023/01/10 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/kuper0201/">Jeong Junsu</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2042 단어"> <em>11 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="음성으로-tv를-제어해-보자">음성으로 TV를 제어해 보자!</h1><p>이 전 글에서는 리모컨의 적외선 신호를 복제하는 방법에 대하여 다뤘다. 이번 글에서는 복제한 신호를 이용해 실제로 TV를 제어 할 수 있는 장치를 만들어 보도록 하겠다.</p><p>아두이노를 이용해 외부와의 연결 없이 테스트를 할 수도 있지만, 다른 장치에서 인식된 음성으로 제어하기 위해 외부와의 연결이 필요하다. 물론 음성인식 엔진을 아두이노에 직접 올린다면 오프라인으로 음성 인식과 제어 둘 다 가능하겠지만, 성능상의 문제와 직접 음성인식 엔진을 구현해야 한다는 문제가 있다. 이 때문에 필자는 WIFI 모듈을 이용하여 외부의 음성인식 엔진과 통신을 하는 방식으로 구현 할 생각이다.</p><p>ESP-01 모듈은 Espressif Systems 에서 개발한 와이파이 모듈로, 가격이 저렴하고 소형이기 때문에 와이파이 모듈 중에서는 가장 범용적이고, 상당히 많은 개발 환경을 지원한다고 한다. 겉핥기 식이긴 하지만, 직접 다른 개발 환경(Lua, Sming)을 사용해 본 결과 복잡하고 불편하다고 느꼈기 때문에 이 글에서는 비교적 간단한 아두이노 스케치를 이용할 것이다.</p><p>ESP-01을 아두이노 스케치로 프로그래밍 하려면 먼저 아두이노 스케치에 보드 정보와 라이브러리를 추가 해 주어야 한다. 아두이노 IDE의 Preferences로 가서 “추가적인 보드 매니저 URLs”에 아래의 링크를 추가 해 주도록 한다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://arduino.esp8266.com/stable/package_esp8266com_index.json
</pre></table></code></div></div><p>그 후, 툴-보드-보드 매니저를 실행하여 검색 창에 esp를 입력하면 esp8266 보드를 찾을 수 있을 것이다. 설치하도록 하자.</p><p>이렇게 하면 일단 보드에 관한 설정은 끝난 것이다. 이제 사용할 라이브러리들을 추가해 주도록 하겠다. 아두이노 IDE의 스케치-라이브러리 포함하기-라이브러리 관리를 클릭하면 라이브러리 매니저가 보일 것이다. 검색 창에 irremoteesp 라고 입력 하여 esp01에서 적외선 센서를 제어 할 수 있게 해 주는 라이브러리를 설치하자.</p><p>위의 모든 작업을 마쳤으면 파일-새 파일을 클릭해 새 파일을 만들고, 내부의 모든 내용을 지우고 아래의 코드를 붙여넣기 하면 된다. 와이파이 변수 부분과 리모컨 각각 기능의 신호값은 자신의 환경에 맞게 설정하도록 하자.</p><details> <summary>코드 보기</summary><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;ESP8266WiFi.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;WiFiUdp.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;IRremoteESP8266.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;IRsend.h&gt;</span><span class="cp">
</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ssid</span> <span class="o">=</span> <span class="s">"자신의 WIFI ssid"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"자신의 WIFI 암호"</span><span class="p">;</span>

<span class="n">IRsend</span> <span class="nf">send</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="n">WiFiUDP</span> <span class="n">Udp</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">localUdpPort</span> <span class="o">=</span> <span class="mi">8011</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">incomingPacket</span><span class="p">[</span><span class="mi">255</span><span class="p">];</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">FUNCTION_3</span><span class="p">);</span>
  <span class="n">pinMode</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>

  <span class="n">pinMode</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
  <span class="n">digitalWrite</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">LOW</span><span class="p">);</span>

  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>

  <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>

  <span class="n">Udp</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">localUdpPort</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">tvTurn</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//전원 상태 변경</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE807F</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xE0E040BF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x20DF10EF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE8F80</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">volumeUp</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//볼륨 업</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xE0E0E01F</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x20DF40BF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">volumeDown</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//볼륨 다운</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xE0E0D02F</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x20DFC03F</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">channelUp</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//채널 업</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE02FD</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">channelDown</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//채널 다운</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE827D</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">zero</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//0</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE04FB</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">one</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//1</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE847B</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">two</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//2</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE44BB</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">three</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//3</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEC43B</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">four</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//4</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE24DB</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">five</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//5</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEA45B</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">six</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//6</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE649B</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">seven</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//7</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEE41B</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">eight</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//8</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE14EB</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">nine</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">//9</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FE946B</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
  <span class="n">send</span><span class="p">.</span><span class="n">sendNEC</span><span class="p">(</span><span class="mh">0x1FEFF00</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">loop</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">packetSize</span> <span class="o">=</span> <span class="n">Udp</span><span class="p">.</span><span class="n">parsePacket</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">packetSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">Udp</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">incomingPacket</span><span class="p">,</span> <span class="mi">255</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">incomingPacket</span><span class="p">[</span><span class="n">len</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"trn"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">tvTurn</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"cUp"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">channelUp</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"cDn"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">channelDown</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"vUp"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">volumeUp</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"vDn"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">volumeDown</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"0"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">zero</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"1"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">one</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"2"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">two</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"3"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">three</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"4"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">four</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"5"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">five</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"6"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">six</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"7"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">seven</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"8"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">eight</span><span class="p">();</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="s">"9"</span><span class="p">,</span> <span class="n">incomingPacket</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">nine</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></details><p><br /></p><p>위의 코드를 보드에 업로드 하기 위해서 회로를 구성해야 한다. 하지만 ESP-01모듈에는 펌웨어를 업로드할수 있는 프로그래머가 없기 때문에 FTDI라는 외장 프로그래머를 사용해야 한다. 아래 그림에서 빨간 부품이 FTDI이고 파란 부품이 ESP-01이다.</p><p><a href="/assets/images/irremote2/20200311_esp01_flash_circuit.png" class="popup img-link "><img data-src="/assets/images/irremote2/20200311_esp01_flash_circuit.png" alt="플래싱 회로 구성" class="lazyload" data-proofer-ignore></a></p><p>회로 구성을 완료 한 후 아두이노 IDE의 툴-보드를 Generic ESP8266 Module로 설정하고 컴파일/업로드를 한다. 업로드 중에 보드에 연결중이라는 메세지가 나오면 ESP-01의 CH_PD핀을 뽑았다가 다시 꽂아준다. ESP-01의 CH_PD핀은 MCU의 활성 상태를 나타내는데, High이면 활성 Low이면 비활성 상태이다. 핀을 뽑았다가 다시 꽂아주는 행위는 esp8266칩(MCU)을 재부팅 시킨다 라고 이해하면 되겠다.</p><p>이렇게 보드에 업로드작업까지 완료했다. 이제 펌웨어가 구워진 보드를 가지고 실제로 TV를 제어할 수 있도록 플래싱용 회로를 실행용 회로로 다시 꾸며야 한다. 아래의 그림과 같이 적외선 LED를 포함하여 회로를 재구성하도록 하자.</p><p><a href="/assets/images/irremote2/20200311_esp01_ir_run_circuit.png" class="popup img-link "><img data-src="/assets/images/irremote2/20200311_esp01_ir_run_circuit.png" alt="실행 회로 구성" class="lazyload" data-proofer-ignore></a></p><p>마지막으로 완성된 회로가 잘 동작하는지 확인하기 위해 직접 UDP로 신호를 보내보겠다. UDP신호를 생성하기 위해 <a href="https://packetsender.com/">여기</a>의 프로그램(PacketSender)을 다운로드/설치 실행 한다.</p><p><a href="/assets/images/irremote2/20200311_packetsender_setting.png" class="popup img-link "><img data-src="/assets/images/irremote2/20200311_packetsender_setting.png" alt="Packetsender 설정" class="lazyload" data-proofer-ignore></a></p><p>그럼 위와 같은 창이 열릴텐데 ASCII 부분에는 전송하고싶은 메세지 (여기에서는 TV를 켜거나 끄라는 의미로 trn을 넣었다), Address는 ESP-01의 ip주소, Port는 8011로 설정한 뒤 TCP라고 써있는 부분을 클릭해 UDP로 변경해 주도록 한다. 그리고 Send버튼을 클릭하면 ESP-01로 TV를 켜라는 메세지가 가게 된다.</p><p>TV앞에 두고 UDP신호를 전송하여 잘 동작이 되는지 테스트 하면 된다. 만일 TV앞에 가는것이 귀찮거나 불가능하다면 휴대폰의 카메라를 통해 적외선 LED를 보면 적외선 LED가 깜빡이는지 확인 할 수 있다. 휴대폰 카메라를 이용한 확인은 적외선 신호가 잘 나오는지 아닌지에 대해서만 확인 가능하며, 신호가 잘 나온다 하더라도 잡음이나 신호 캡쳐의 문제 등 다른 이유에 의해 TV의 전원은 on/off되지 않을 수 있다.</p><p>이번에는 udp 패킷을 수동으로 생성하여 신호를 전송하는 방식으로 구현했으므로 다음 글에서는 특정 음성이 인식되면 자동으로 udp 패킷을 생성하여 신호를 전송하도록 해 보겠다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EA%B0%9C%EC%9D%B8%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8/'>개인프로젝트</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/projects/" class="post-tag no-text-decoration" >Projects</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=음성으로 TV제어하기 - 2.TV 제어 - kuper1712의 블로그&url=https%3A%2F%2Fkuper1712.github.io%2Fposts%2Fir-remote2%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=음성으로 TV제어하기 - 2.TV 제어 - kuper1712의 블로그&u=https%3A%2F%2Fkuper1712.github.io%2Fposts%2Fir-remote2%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkuper1712.github.io%2Fposts%2Fir-remote2%2F&text=음성으로 TV제어하기 - 2.TV 제어 - kuper1712의 블로그" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/boj-3495/">BOJ 3495 아스키 도형</a><li><a href="/posts/boj-10814/">BOJ 10814 나이순 정렬</a><li><a href="/posts/boj-1181/">BOJ 1181 단어 정렬</a><li><a href="/posts/boj-18870/">BOJ 18870 좌표 압축</a><li><a href="/posts/ir-remote3/">음성으로 TV제어하기 - 3.음성 인식</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/projects/">Projects</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ir-remote1/"><div class="card-body"> <em class="small" data-ts="1583107200" data-df="YYYY/MM/DD" > 2020/03/02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>음성으로 TV제어하기 - 1.신호 복제</h3><div class="text-muted small"><p> 음성으로 TV를 제어해 보자! 여가 생활을 즐기기 위해 TV를 보려 하면 리모컨이 저 멀리 있거나, 어디 있는지 모를 때가 많다. 그럴 때마다 한번 쯤은 리모컨 없이 기계를 제어하는 상상을 해 보았을 것이다. 물론 현재 시중에는 더욱 쉽고 다양한 방법으로 제어 할 수 있도록 개발된 제품이 많이 출시되어 있지만 이를 위해 새 TV를 사거나 AI 스피커...</p></div></div></a></div><div class="card"> <a href="/posts/ir-remote3/"><div class="card-body"> <em class="small" data-ts="1583280000" data-df="YYYY/MM/DD" > 2020/03/04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>음성으로 TV제어하기 - 3.음성 인식</h3><div class="text-muted small"><p> 음성으로 TV를 제어해 보자! 지금까지는 음성인식 후의 신호를 만들어주는 부분을 구현했다. 이번에는 실제로 음성인식을 수행하는 부분을 만들어 볼 것이다. 필자는 이 프로젝트를 진행하며 직접 음성인식 모델을 구축할지, 기존에 제작되어 있는 API를 가져다 쓸 지에 대하여 고민을 많이 했다. 음성인식 모델을 직접 구현해보니 음성데이터와 컴퓨팅 파워가 ...</p></div></div></a></div><div class="card"> <a href="/posts/boj-3495/"><div class="card-body"> <em class="small" data-ts="1646265600" data-df="YYYY/MM/DD" > 2022/03/03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>BOJ 3495 아스키 도형</h3><div class="text-muted small"><p> BOJ 문제 풀이 문제 (link) 창영이는 메모장에 ., \, /을 이용해서 도형을 그렸다. 각 문자는 그림에서 1*1크기의 단위 정사각형을 나타낸다. .은 빈 칸을 나타내며, /는 정사각형의 왼쪽 아래 꼭짓점과 오른쪽 위 꼭짓점이 연결된 선분을, \은 왼쪽 위 꼭짓점과 오른쪽 아래 꼭짓점이 연결된 선분을 나타낸다. 창영이가 그린 도형의 넓이를 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ir-remote1/" class="btn btn-outline-primary" prompt="이전 글"><p>음성으로 TV제어하기 - 1.신호 복제</p></a> <a href="/posts/ir-remote3/" class="btn btn-outline-primary" prompt="다음 글"><p>음성으로 TV제어하기 - 3.음성 인식</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/projects/">Projects</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/kuper1712">kuper1712</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/unregister.js"></script>
